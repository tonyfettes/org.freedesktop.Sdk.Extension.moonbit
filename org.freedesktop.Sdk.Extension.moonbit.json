{
  "id": "org.freedesktop.Sdk.Extension.moonbit",
  "branch": "23.08",
  "runtime": "org.freedesktop.Sdk",
  "build-extension": true,
  "sdk": "org.freedesktop.Sdk",
  "runtime-version": "23.08",
  "separate-locales": false,
  "appstream-compose": false,
  "modules": [
    {
      "name": "moonbit",
      "buildsystem": "simple",
      "sources": [
        {
          "type": "archive",
          "only-arches": [
            "x86_64"
          ],
          "url": "https://cli.moonbitlang.com/binaries/latest/moonbit-linux-x86_64.tar.gz",
          "sha256": "5c1af48342cf0bed2325b38b1ed23fcadec392cedfe9a61b1485a0f48e53b7c5"
        }
      ],
      "build-commands": [
        "install -d /usr/lib/sdk/moonbit/bin",
        "chmod a+x moon*",
        "cp -rpv * /usr/lib/sdk/moonbit/bin/"
      ]
    },
    {
      "name": "core",
      "buildsystem": "simple",
      "sources": [
        {
          "type": "archive",
          "url": "https://cli.moonbitlang.com/cores/core-latest.tar.gz",
          "sha256": "a9f6849daa355ec61835b471119f0844ef1cd373c0b1b852e71573afd239b8f3"
        }
      ],
      "build-commands": [
        "install -d /usr/lib/sdk/moonbit/lib",
        "cp -rpv * /usr/lib/sdk/moonbit/lib/",
        "MOON_HOME=/usr/lib/sdk/moonbit PATH=/usr/lib/sdk/moonbit/bin moon bundle --all --source-dir /usr/lib/sdk/moonbit/lib/core"
      ]
    },
    {
      "name": "scripts",
      "sources": [
        {
          "type": "script",
          "commands": [
            "export MOON_HOME=/usr/lib/sdk/moonbit",
            "export PATH=$PATH:$MOON_HOME/bin"
          ],
          "dest-filename": "enable.sh"
        }
      ],
      "buildsystem": "simple",
      "build-commands": [
        "install -Dm755 enable.sh /usr/lib/sdk/moonbit/enable.sh"
      ]
    },
    {
      "name": "metainfo",
      "buildsystem": "simple",
      "build-commands": [
        "install -Dm644 org.freedesktop.Sdk.Extension.moonbit.metainfo.xml ${FLATPAK_DEST}/share/metainfo/org.freedesktop.Sdk.Extension.moonbit.metainfo.xml",
        "appstream-compose  --basename=org.freedesktop.Sdk.Extension.moonbit --prefix=${FLATPAK_DEST} --origin=flatpak org.freedesktop.Sdk.Extension.moonbit"
      ],
      "sources": [
        {
          "type": "file",
          "path": "org.freedesktop.Sdk.Extension.moonbit.metainfo.xml"
        }
      ]
    }
  ]
}
